ただただ書いただけで調整してないので、書き方そのものはかなり改善の余地あり。でもとりあえず動くからよし。